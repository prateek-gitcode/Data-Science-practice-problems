setwd("D:/Data science materials/Assignments/Random Forest")
library(readr)
company_data <- read_csv(file.choose())
company_data$NewSales <- as.factor(ifelse(company_data$Sales>7.49,1,0))
company_data$Urban <- as.factor(company_data$Urban)
company_data$US <- as.factor(company_data$US)
library(caTools)
set.seed(123)
split <- sample.split(company_data$Sales,SplitRatio = 0.90)
train_set <- subset(company_data,split==TRUE)
test_set <- subset(company_data,split==FALSE)
library(randomForest)
model <- randomForest(formula = NewSales~.,data=train_set,method='class')
summary(model)
y_pred <- predict(model,newdata = test_set,type = 'class')
library(gmodels)
CrossTable(y_pred,test_set$NewSales)
accuracy <- mean(y_pred==test_set$NewSales)
setwd("D:/Data science materials/Assignments/Random Forest")
library(readr)
fraud_data <- read_csv(file.choose())
fraud_data$Fraud <- factor(ifelse(fraud_data$Taxable.Income>30000,"Good","Risky"))
library(caTools)
split <- sample.split(fraud_data$Fraud,SplitRatio =0.80)
train_data <- subset(fraud_data,split==TRUE)
test_data <- subset(fraud_data,split==FALSE)
#Preparing the model
library(randomForest)
classifier <- randomForest(formula = Fraud ~ City.Population + factor(Marital.Status) + Taxable.Income+
factor(Undergrad)+Work.Experience,data=train_data,importance=TRUE,na.action = na.roughfix)
View(fraud_data)
View(fraud_data)
classifier <- randomForest(formula = Fraud ~ City.Population + factor(fraud_data$Marital.Status) + Taxable.Income+
factor(Undergrad)+Work.Experience,data=train_data,importance=TRUE,na.action = na.roughfix)
classifier <- randomForest(formula = Fraud ~ City.Population + factor(Marital.Status) + Taxable.Income+
factor(Undergrad)+Work.Experience,data=train_data,importance=TRUE,na.action = na.roughfix)
summary(classifier)
classifier <- randomForest(formula = Fraud ~ City.Population + as.factor(Marital.Status) + Taxable.Income+
as.factor(Undergrad)+Work.Experience,data=train_data,importance=TRUE,na.action = na.roughfix)
library(readr)
fraud_data <- read_csv(file.choose())
fraud_data$Fraud <- factor(ifelse(fraud_data$Taxable.Income>30000,"Good","Risky"))
attach(fraud_data)
library(caTools)
split <- sample.split(fraud_data$Fraud,SplitRatio =0.80)
train_data <- subset(fraud_data,split==TRUE)
test_data <- subset(fraud_data,split==FALSE)
#Preparing the model
library(randomForest)
classifier <- randomForest(formula = Fraud ~ City.Population + factor(Marital.Status) + Taxable.Income+
factor(Undergrad)+Work.Experience,data=train_data,importance=TRUE,na.action = na.roughfix)
View(fraud_data)
fraud_data$Fraud <- factor(ifelse(fraud_data$Taxable.Income>30000,"Good","Risky"))
fraud_data$Marital.Status=factor(fraud_data$Marital.Status,levels = c(0,1,2))
attach(fraud_data)
library(readr)
fraud_data <- read_csv(file.choose())
fraud_data$Fraud <- factor(ifelse(fraud_data$Taxable.Income>30000,"Good","Risky"))
fraud_data$Marital.Status=factor(fraud_data$Marital.Status,levels = c(0,1,2))
attach(fraud_data)
View(fraud_data)
View(fraud_data)
library(readr)
fraud_data <- read_csv(file.choose())
fraud_data$Fraud <- factor(ifelse(fraud_data$Taxable.Income>30000,"Good","Risky"))
View(fraud_data)
fraud_data$Marital.Status=factor(fraud_data$Marital.Status,levels = c('Single','Married','Divorced'),labels = c(1,2,3))
attach(fraud_data)
View(fraud_data)
library(caTools)
split <- sample.split(fraud_data$Fraud,SplitRatio =0.80)
train_data <- subset(fraud_data,split==TRUE)
test_data <- subset(fraud_data,split==FALSE)
#Preparing the model
library(randomForest)
classifier <- randomForest(formula = Fraud ~ City.Population + Marital.Status + Taxable.Income+
factor(Undergrad)+Work.Experience,data=train_data,importance=TRUE,na.action = na.roughfix)
